---
title: "Actual Statistics"
output:
  html_document:
    df_print: paged
---
# Simple Results for Border Districts

```{r}

BasicResults <- function(DataFrame, RHS, PartialLHS){ 
  list(
lm(as.formula(paste(PartialLHS[1],"~", RHS)), DataFrame[DataFrame$GradeThree>0,]),
lm( as.formula(paste(PartialLHS[2],"~", RHS)), DataFrame[DataFrame$GradeThree>0,]),
lm( as.formula(paste(PartialLHS[3],"~", RHS)), DataFrame[DataFrame$GradeThree>0,]),
lm( as.formula(paste(PartialLHS[4],"~", RHS)), DataFrame[DataFrame$GradeThree>0,]),
lm( as.formula(paste(PartialLHS[5],"~", RHS)), DataFrame[DataFrame$GradeThree>0,]),

lm(as.formula(paste(PartialLHS[1],"~", RHS)), DataFrame[DataFrame$GradeEight>0,]),
lm( as.formula(paste(PartialLHS[2],"~", RHS)), DataFrame[DataFrame$GradeEight>0,]),
lm( as.formula(paste(PartialLHS[3],"~", RHS)), DataFrame[DataFrame$GradeEight>0,]),
lm( as.formula(paste(PartialLHS[4],"~", RHS)), DataFrame[DataFrame$GradeEight>0,]),
lm( as.formula(paste(PartialLHS[5],"~", RHS)), DataFrame[DataFrame$GradeEight>0,]),

lm( as.formula(paste(PartialLHS[1],"~", RHS)), DataFrame[DataFrame$GradeEleven>0,]),
lm( as.formula(paste(PartialLHS[2],"~", RHS)), DataFrame[DataFrame$GradeEleven>0,]),
lm(as.formula(paste(PartialLHS[3],"~", RHS)), DataFrame[DataFrame$GradeEleven>0,]),
lm(as.formula(paste(PartialLHS[4] ,"~", RHS)), DataFrame[DataFrame$GradeEleven>0,]),
lm(as.formula(paste(PartialLHS[5],"~", RHS)), DataFrame[DataFrame$GradeEleven>0,]))
}
```


Should give rough idea
```{r}
library(dplyr)

BorderOnlySchools <- Master %>% 
  semi_join(BorderDistricts, by = c("DistrictID" = "District.ID"))  
  

LHS <- c("ELALogit", "MathLogit","ReadingLogit", "ScienceLogit", "WritingLogit")

partform <- "Eligible + NewlyTreated + Treated + as.factor(Year) + MalePct + WhitePct + AAPct + HispanicPct + AsianPct + FreeLunchPct + as.factor(DistrictID)"

SimpleResults <- BasicResults(BorderOnlySchools, partform, LHS )

lapply(SimpleResults, summary)
```

Now only ineligible vs Evertreated, regression discontinuity test
```{r}
library(dplyr)

RegressionDiscontinuity <- Master %>% 
  semi_join(BorderDistricts, by = c("DistrictID" = "District.ID")) %>%
  filter(Eligible == "NO"  | EverTreated == TRUE)
  

LHS <- c("ELALogit", "MathLogit","ReadingLogit", "ScienceLogit", "WritingLogit")

partform <- "Eligible + Treated + as.factor(Year) + MalePct + WhitePct + AAPct + HispanicPct + AsianPct"

RegDiscResults <- BasicResults(RegressionDiscontinuity, partform, LHS )

lapply(RegDiscResults, summary)

```

```{r}
library(dplyr)

RegressionDiscontinuity <- Master %>% 
  semi_join(BorderDistricts, by = c("DistrictID" = "District.ID")) %>%
  filter(Eligible == "NO"  | EverTreated == TRUE)

RegressionDiscontinuity %>%
  select(Attendance, AttendanceLogit) %>% View()

LHS <- rep("AttendanceLogit",5)

partform <- "Eligible + Treated + as.factor(Year) + MalePct + WhitePct + AAPct + HispanicPct + AsianPct"

AttendanceModel <- function(DataFrame, RHS, PartialLHS){ 
  list(
lm(as.formula(paste(PartialLHS,"~", RHS)), DataFrame[DataFrame$GradeThree>0,]),
lm(as.formula(paste(PartialLHS,"~", RHS)), DataFrame[DataFrame$GradeEight>0,]),
lm(as.formula(paste(PartialLHS,"~", RHS)), DataFrame[DataFrame$GradeEleven>0,]))
  }

AttendanceResults <- AttendanceModel(RegressionDiscontinuity, partform, "AttendanceLogit")

lapply(AttendanceResults, summary)

```

